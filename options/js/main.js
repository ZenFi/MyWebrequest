// Generated by CoffeeScript 1.10.0
var indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

define(function(require) {
  var dialog, isPageCat, onHashChange, pageCtrls, pageIds;
  pageCtrls = {
    union: require('js/union-page'),
    qrcode: require('js/qr-page'),
    utility: require('js/utility-page'),
    'ext-settings': require('js/ext-settings-page'),
    help: require('js/help-page')
  };
  pageIds = $('#nav>li>a').map(function() {
    var href;
    href = this.getAttribute('href');
    if (href[0] === '#') {
      return href.replace('#', '');
    }
  }).get();
  require('lib/artdialog/css/ui-dialog.css');
  dialog = require('dialog');

  /**
   * check a setting section cat
   * @param  {String}  cat cat name
   * @return {Boolean}
   */
  isPageCat = function(cat) {
    var ref;
    return ref = (cat || '').replace('#', ''), indexOf.call(pageIds, ref) >= 0;
  };
  onHashChange = function(e, hash) {
    var $navLink, $unionCat, cat, hashes, matches, others, ref;
    if (e) {
      matches = /#(.*)$/.exec(e.newURL);
      if (!matches) {
        return;
      }
      hash = matches[1];
    }
    hashes = hash.split('/');
    cat = hashes.shift();
    others = hashes.join('/');
    if (!isPageCat(cat)) {
      return;
    }
    $navLink = $("#nav a[href^=#" + cat + "]").parent();
    if ($navLink.hasClass('active')) {
      return;
    }
    $navLink.siblings().removeClass('active');
    $navLink.addClass('active');
    $('section').removeClass('active');
    $unionCat = $('#request-settings');
    $unionCat.removeClass('active');
    if (pageCtrls.union.isUnionCat(cat)) {
      pageCtrls.union.init(cat, others);
      setTimeout(function() {
        $unionCat.addClass('active');
      }, 100);
    } else {
      $("section#" + cat).addClass('active');
      if ((ref = pageCtrls[cat]) != null) {
        ref.init(cat, others);
      }
    }
  };
  window.onhashchange = onHashChange;
  (function() {
    var cat;
    cat = location.hash.replace('#', '');
    if (!isPageCat(cat.split('/')[0])) {
      cat = 'custom';
    }
    onHashChange(null, cat);
  })();
});


//# sourceMappingURL=main.js.map
